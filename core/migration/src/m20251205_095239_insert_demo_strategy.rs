use chrono::Utc;
use entity::strategy_config::{ActiveModel as StrategyConfigActiveModel, Entity as StrategyConfigEntity};
use sea_orm_migration::{
    prelude::*,
    sea_orm::{entity::*, query::*},
};
use serde_json::json;

#[derive(DeriveMigrationName)]
pub struct Migration;

#[async_trait::async_trait]
impl MigrationTrait for Migration {
    async fn up(&self, manager: &SchemaManager) -> Result<(), DbErr> {
        let nodes = json!([{"data":{"backtestConfig":{"customVariables":[{"initialValue":0.1,"previousValue":0.1,"varDisplayName":"Test","varName":"test1","varType":"custom","varValue":0.1,"varValueType":"number"}],"dataSource":"exchange","exchangeModeConfig":{"selectedAccounts":[{"accountName":"Binance","availableBalance":0,"exchange":"binance","id":1}],"timeRange":{"endDate":"2025-11-29 00:00:00 +08:00","startDate":"2025-11-27 00:00:00 +08:00"}},"feeRate":0.001,"fileModeConfig":null,"initialBalance":100000,"leverage":5,"playSpeed":50},"liveConfig":null,"nodeConfig":{"borderColor":"#10b981","handleColor":"#10b981","iconBackgroundColor":"#10b981","iconName":"play","isHovered":false},"nodeName":"Start Node","simulateConfig":null,"strategyId":11,"strategyName":"test1"},"dragging":false,"id":"start_node","measured":{"height":444,"width":266},"position":{"x":-483.668088019339,"y":1.0494726597365265},"selected":false,"type":"startNode"},{"data":{"backtestConfig":{"dataSource":"exchange","exchangeModeConfig":{"selectedAccount":{"accountName":"Binance","availableBalance":0,"exchange":"binance","id":1},"selectedSymbols":[{"configId":1,"interval":"1m","klineValue":{"close":0,"datetime":"","high":0,"low":0,"open":0,"volume":0},"outputHandleId":"kline_node_lz202ib_output_1","symbol":"BTCUSDT"},{"configId":2,"interval":"15m","klineValue":{"close":0,"datetime":"","high":0,"low":0,"open":0,"volume":0},"outputHandleId":"kline_node_lz202ib_output_2","symbol":"BTCUSDT"},{"configId":3,"interval":"1h","klineValue":{"close":0,"datetime":"","high":0,"low":0,"open":0,"volume":0},"outputHandleId":"kline_node_lz202ib_output_3","symbol":"BTCUSDT"}],"timeRange":{"endDate":"2025-11-29 00:00:00 +08:00","startDate":"2025-11-27 00:00:00 +08:00"}},"fileModeConfig":null},"nodeConfig":{"borderColor":"#3b82f6","handleColor":"#3b82f6","iconBackgroundColor":"#3b82f6","iconName":"chart-candlestick","isHovered":false},"nodeName":"Obtain Btc Price","strategyId":11,"strategyName":"test1"},"dragging":false,"id":"kline_node_lz202ib","measured":{"height":318,"width":200},"position":{"x":12.972727393540625,"y":-105.1620036168406},"selected":false,"type":"klineNode"},{"data":{"backtestConfig":{"dataSource":"exchange","exchangeModeConfig":{"selectedAccount":{"accountName":"Binance","availableBalance":0,"exchange":"binance","id":1},"selectedIndicators":[{"configId":1,"indicatorConfig":{"devDown":2,"devUp":2,"maType":"SMA","priceSource":"CLOSE","timePeriod":20},"indicatorType":"bbands","outputHandleId":"indicator_node_cbmgv8l_output_1","value":{"lower":0,"middle":0,"timestamp":0,"upper":0}}],"selectedSymbol":{"configId":2,"interval":"15m","klineValue":{"close":0,"datetime":"","high":0,"low":0,"open":0,"volume":0},"outputHandleId":"kline_node_lz202ib_output_2","symbol":"BTCUSDT"},"timeRange":{"endDate":"2025-11-29 00:00:00 +08:00","startDate":"2025-11-27 00:00:00 +08:00"}},"fileModeConfig":null},"nodeConfig":{"borderColor":"#8b5cf6","handleColor":"#8b5cf6","iconBackgroundColor":"#8b5cf6","iconName":"chart-line","isHovered":false},"nodeName":"Calculate BBands","strategyId":11,"strategyName":"test1"},"dragging":false,"id":"indicator_node_cbmgv8l","measured":{"height":270,"width":400},"position":{"x":524.7020095667865,"y":339.2943464644279},"selected":false,"type":"indicatorNode"},{"data":{"backtestConfig":{"dataSource":"exchange","exchangeModeConfig":{"selectedAccount":{"accountName":"Binance","availableBalance":0,"exchange":"binance","id":1}},"variableConfigs":[{"configId":1,"inputHandleId":"variable_node_195jb3q_input_1","outputHandleId":"variable_node_195jb3q_output_1","triggerConfig":{"config":{"errorPolicy":{"expired":{"errorLog":{"notify":false},"strategy":"skip"},"nullValue":{"errorLog":{"notify":false},"strategy":"skip"},"zeroValue":{"errorLog":{"notify":false},"strategy":"skip"}},"expireDuration":{"duration":1,"unit":"hour"},"fromHandleId":"indicator_node_cbmgv8l_output_1","fromNodeId":"indicator_node_cbmgv8l","fromNodeName":"Calculate BBands","fromNodeType":"indicatorNode","fromVar":"lower","fromVarConfigId":1,"fromVarDisplayName":"Lower","fromVarValueType":"number"},"type":"dataflow"},"updateOperationValue":null,"updateVarValueOperation":"set","varDisplayName":"Test","varName":"test1","varOperation":"update","varType":"custom","varValueType":"number"}]},"nodeConfig":{"borderColor":"#06b6d4","handleColor":"#06b6d4","iconBackgroundColor":"#06b6d4","iconName":"variable","isHovered":false},"nodeName":"Update Custom Variable","strategyId":11,"strategyName":"Demo Strategy"},"dragging":false,"id":"variable_node_195jb3q","measured":{"height":154,"width":332},"position":{"x":1268.7359727120147,"y":340.00244948773565},"selected":false,"type":"variableNode"},{"data":{"backtestConfig":{"dataSource":"exchange","exchangeModeConfig":{"selectedAccount":{"accountName":"Binance","availableBalance":0,"exchange":"binance","id":1},"selectedIndicators":[{"configId":1,"indicatorConfig":{"maType":"SMA","priceSource":"CLOSE","timePeriod":14},"indicatorType":"ma","outputHandleId":"indicator_node_czmwdz9_output_1","value":{"ma":0,"timestamp":0}},{"configId":2,"indicatorConfig":{"maType":"SMA","priceSource":"CLOSE","timePeriod":21},"indicatorType":"ma","outputHandleId":"indicator_node_czmwdz9_output_2","value":{"ma":0,"timestamp":0}},{"configId":3,"indicatorConfig":{"maType":"SMA","priceSource":"CLOSE","timePeriod":30},"indicatorType":"ma","outputHandleId":"indicator_node_czmwdz9_output_3","value":{"ma":0,"timestamp":0}},{"configId":4,"indicatorConfig":{"maType":"SMA","priceSource":"CLOSE","timePeriod":60},"indicatorType":"ma","outputHandleId":"indicator_node_czmwdz9_output_4","value":{"ma":0,"timestamp":0}}],"selectedSymbol":{"configId":1,"interval":"1m","klineValue":{"close":0,"datetime":"","high":0,"low":0,"open":0,"volume":0},"outputHandleId":"kline_node_lz202ib_output_1","symbol":"BTCUSDT"},"timeRange":{"endDate":"2025-11-29 00:00:00 +08:00","startDate":"2025-11-27 00:00:00 +08:00"}},"fileModeConfig":null},"nodeConfig":{"borderColor":"#8b5cf6","handleColor":"#8b5cf6","iconBackgroundColor":"#8b5cf6","iconName":"chart-line","isHovered":false},"nodeName":"Calculate Ma","strategyId":11,"strategyName":"Demo Strategy"},"dragging":false,"id":"indicator_node_czmwdz9","measured":{"height":446,"width":342},"position":{"x":509.70004748070846,"y":-391.6646604483675},"selected":false,"type":"indicatorNode"},{"data":{"backtestConfig":{"cases":[{"caseId":1,"conditions":[{"comparisonSymbol":">","conditionId":1,"left":{"nodeId":"indicator_node_czmwdz9","nodeName":"Calculate Ma","nodeType":"indicatorNode","outputHandleId":"indicator_node_czmwdz9_output_1","varConfigId":1,"varDisplayName":"MA","varName":"ma","varType":"variable","varValueType":"number"},"right":{"nodeId":"indicator_node_czmwdz9","nodeName":"Calculate Ma","nodeType":"indicatorNode","outputHandleId":"indicator_node_czmwdz9_output_2","varConfigId":2,"varDisplayName":"MA","varName":"ma","varType":"variable","varValueType":"number"}},{"comparisonSymbol":">","conditionId":2,"left":{"nodeId":"indicator_node_czmwdz9","nodeName":"Calculate Ma","nodeType":"indicatorNode","outputHandleId":"indicator_node_czmwdz9_output_2","varConfigId":2,"varDisplayName":"MA","varName":"ma","varType":"variable","varValueType":"number"},"right":{"nodeId":"indicator_node_czmwdz9","nodeName":"Calculate Ma","nodeType":"indicatorNode","outputHandleId":"indicator_node_czmwdz9_output_3","varConfigId":3,"varDisplayName":"MA","varName":"ma","varType":"variable","varValueType":"number"}},{"comparisonSymbol":">","conditionId":3,"left":{"nodeId":"indicator_node_czmwdz9","nodeName":"Calculate Ma","nodeType":"indicatorNode","outputHandleId":"indicator_node_czmwdz9_output_3","varConfigId":3,"varDisplayName":"MA","varName":"ma","varType":"variable","varValueType":"number"},"right":{"nodeId":"indicator_node_czmwdz9","nodeName":"Calculate Ma","nodeType":"indicatorNode","outputHandleId":"indicator_node_czmwdz9_output_4","varConfigId":4,"varDisplayName":"MA","varName":"ma","varType":"variable","varValueType":"number"}}],"logicalSymbol":"and","outputHandleId":"if_else_node_kkhbgbs_output_1"}]},"isNested":false,"nodeConfig":{"borderColor":"#f59e0b","handleColor":"#f59e0b","iconBackgroundColor":"#f59e0b","iconName":"git-branch","isHovered":false},"nodeName":"Is Long Trend","strategyId":11,"strategyName":"Demo Strategy"},"dragging":false,"id":"if_else_node_kkhbgbs","measured":{"height":204,"width":258},"position":{"x":1165.8005540735646,"y":-335.05675040477684},"selected":false,"type":"ifElseNode"},{"data":{"backtestConfig":{"dataSource":"exchange","exchangeModeConfig":{"selectedAccount":{"accountName":"Binance","availableBalance":0,"exchange":"binance","id":1}},"variableConfigs":[{"configId":1,"inputHandleId":"variable_node_178srlo_input_1","outputHandleId":"variable_node_178srlo_output_1","symbol":"BTCUSDT","triggerConfig":{"config":{"caseId":1,"fromHandleId":"if_else_node_kkhbgbs_output_1","fromNodeId":"if_else_node_kkhbgbs","fromNodeName":"Is Long Trend","fromNodeType":"ifElseNode","triggerType":"case"},"type":"condition"},"varDisplayName":"Current Position Amount","varName":"current_position_amount","varOperation":"get","varType":"system","varValue":null,"varValueType":"number"}]},"nodeConfig":{"borderColor":"#06b6d4","handleColor":"#06b6d4","iconBackgroundColor":"#06b6d4","iconName":"variable","isHovered":false},"nodeName":"Get Btc Position Count","strategyId":11,"strategyName":"Demo Strategy"},"dragging":false,"id":"variable_node_178srlo","measured":{"height":134,"width":370},"position":{"x":1706.6228861414547,"y":-148.91665984323592},"selected":false,"type":"variableNode"},{"data":{"backtestConfig":{"cases":[{"caseId":1,"conditions":[{"comparisonSymbol":"=","conditionId":1,"left":{"nodeId":"variable_node_178srlo","nodeName":"Get Btc Position Count","nodeType":"variableNode","outputHandleId":"variable_node_178srlo_output_1","varConfigId":1,"varDisplayName":"Current Position Amount","varName":"current_position_amount","varType":"variable","varValueType":"number"},"right":{"varType":"constant","varValue":0,"varValueType":"number"}}],"logicalSymbol":"and","outputHandleId":"if_else_node_ioon3sv_output_1"}]},"isNested":false,"nodeConfig":{"borderColor":"#f59e0b","handleColor":"#f59e0b","iconBackgroundColor":"#f59e0b","iconName":"git-branch","isHovered":false},"nodeName":"If No Position","strategyId":11,"strategyName":"Demo Strategy"},"dragging":false,"id":"if_else_node_ioon3sv","measured":{"height":144,"width":276},"position":{"x":2284.0543390942235,"y":-20.03198127128086},"selected":false,"type":"ifElseNode"},{"data":{"backtestConfig":{"positionOperations":[{"configId":1,"inputHandleId":"position_node_1zwg02h_input_1","operationName":"Close Position","outputHandleIds":["position_node_1zwg02h_success_output_1","position_node_1zwg02h_failed_output_1"],"positionOperation":"ClosePosition","positionOperationId":1,"symbol":"BTCUSDT","triggerConfig":{"caseId":1,"fromHandleId":"if_else_node_958fu8l_output_1","fromNodeId":"if_else_node_958fu8l","fromNodeName":"Profit and loss ratio 1%","fromNodeType":"ifElseNode","triggerType":"case"}}],"selectedAccount":{"accountName":"Binance","availableBalance":0,"exchange":"binance","id":1}},"nodeConfig":{"borderColor":"#ec4899","handleColor":"#ec4899","iconBackgroundColor":"#ec4899","iconName":"wallet","isHovered":false},"nodeName":"Position Node","strategyId":11,"strategyName":"Demo Strategy"},"dragging":false,"id":"position_node_1zwg02h","measured":{"height":192,"width":378},"position":{"x":3685.6728047149218,"y":592.9659577133218},"selected":false,"type":"positionNode"},{"data":{"backtestConfig":{"dataSource":"exchange","exchangeModeConfig":{"selectedAccount":{"accountName":"Binance","availableBalance":0,"exchange":"binance","id":1},"timeRange":{"endDate":"2025-11-29 00:00:00 +08:00","startDate":"2025-11-27 00:00:00 +08:00"}},"futuresOrderConfigs":[{"inputHandleId":"futures_order_node_s3ck6e7_input_1","orderConfigId":1,"orderSide":"LONG","orderType":"MARKET","outputHandleIds":["futures_order_node_s3ck6e7_all_status_output_1","futures_order_node_s3ck6e7_created_output_1","futures_order_node_s3ck6e7_partial_output_1","futures_order_node_s3ck6e7_filled_output_1","futures_order_node_s3ck6e7_canceled_output_1","futures_order_node_s3ck6e7_expired_output_1","futures_order_node_s3ck6e7_rejected_output_1","futures_order_node_s3ck6e7_error_output_1"],"price":0,"quantity":0.1,"sl":null,"slType":"price","symbol":"BTCUSDT","tp":null,"tpType":"price","triggerConfig":{"caseId":1,"fromHandleId":"if_else_node_ioon3sv_output_1","fromNodeId":"if_else_node_ioon3sv","fromNodeName":"If No Position","fromNodeType":"ifElseNode","triggerType":"case"}}]},"nodeConfig":{"borderColor":"#0f766e","handleColor":"#0f766e","iconBackgroundColor":"#0f766e","iconName":"shopping-cart","isHovered":false},"nodeName":"Open Long Market","strategyId":11,"strategyName":"Demo Strategy"},"dragging":false,"id":"futures_order_node_s3ck6e7","measured":{"height":290,"width":332},"position":{"x":2966.057718024478,"y":-170.71422837001396},"selected":false,"type":"futuresOrderNode"},{"data":{"backtestConfig":{"dataSource":"exchange","exchangeModeConfig":{"selectedAccount":{"accountName":"Binance","availableBalance":0,"exchange":"binance","id":1}},"variableConfigs":[{"configId":1,"inputHandleId":"variable_node_gu5vsm9_input_1","outputHandleId":"variable_node_gu5vsm9_output_1","symbol":"BTCUSDT","triggerConfig":{"config":{"fromHandleId":"if_else_node_ioon3sv_output_else","fromNodeId":"if_else_node_ioon3sv","fromNodeName":"If No Position","fromNodeType":"ifElseNode","triggerType":"else"},"type":"condition"},"varDisplayName":"Current ROI","varName":"current_roi","varOperation":"get","varType":"system","varValue":null,"varValueType":"percentage"}]},"nodeConfig":{"borderColor":"#06b6d4","handleColor":"#06b6d4","iconBackgroundColor":"#06b6d4","iconName":"variable","isHovered":false},"nodeName":"BTC Current Roi","strategyId":11,"strategyName":"Demo Strategy"},"dragging":false,"id":"variable_node_gu5vsm9","measured":{"height":134,"width":299},"position":{"x":2696.9167044687233,"y":279.4431904687791},"selected":false,"type":"variableNode"},{"data":{"backtestConfig":{"cases":[{"caseId":1,"conditions":[{"comparisonSymbol":">=","conditionId":1,"left":{"nodeId":"variable_node_gu5vsm9","nodeName":"BTC Current Roi","nodeType":"variableNode","outputHandleId":"variable_node_gu5vsm9_output_1","varConfigId":1,"varDisplayName":"Current ROI","varName":"current_roi","varType":"variable","varValueType":"percentage"},"right":{"varType":"constant","varValue":1,"varValueType":"percentage"}},{"comparisonSymbol":"<=","conditionId":2,"left":{"nodeId":"variable_node_gu5vsm9","nodeName":"BTC Current Roi","nodeType":"variableNode","outputHandleId":"variable_node_gu5vsm9_output_1","varConfigId":1,"varDisplayName":"Current ROI","varName":"current_roi","varType":"variable","varValueType":"percentage"},"right":{"varType":"constant","varValue":-1,"varValueType":"percentage"}}],"logicalSymbol":"or","outputHandleId":"if_else_node_958fu8l_output_1"}]},"isNested":false,"nodeConfig":{"borderColor":"#f59e0b","handleColor":"#f59e0b","iconBackgroundColor":"#f59e0b","iconName":"git-branch","isHovered":false},"nodeName":"Pnl ratio 1%","strategyId":11,"strategyName":"Demo Strategy"},"dragging":false,"id":"if_else_node_958fu8l","measured":{"height":174,"width":259},"position":{"x":3209.6276469118147,"y":446.0291039548535},"selected":false,"type":"ifElseNode"}]);
        let edges = json!([{"id":"start_node.start_node_default_output=>kline_node_lz202ib.kline_node_lz202ib_default_input","selected":false,"source":"start_node","sourceHandle":"start_node_default_output","target":"kline_node_lz202ib","targetHandle":"kline_node_lz202ib_default_input","type":"customEdge"},{"id":"kline_node_lz202ib.kline_node_lz202ib_output_2=>indicator_node_cbmgv8l.indicator_node_cbmgv8l_default_input","selected":false,"source":"kline_node_lz202ib","sourceHandle":"kline_node_lz202ib_output_2","target":"indicator_node_cbmgv8l","targetHandle":"indicator_node_cbmgv8l_default_input","type":"customEdge"},{"id":"indicator_node_cbmgv8l.indicator_node_cbmgv8l_output_1=>variable_node_195jb3q.variable_node_195jb3q_default_input","selected":false,"source":"indicator_node_cbmgv8l","sourceHandle":"indicator_node_cbmgv8l_output_1","target":"variable_node_195jb3q","targetHandle":"variable_node_195jb3q_default_input","type":"customEdge"},{"id":"kline_node_lz202ib.kline_node_lz202ib_output_1=>indicator_node_czmwdz9.indicator_node_czmwdz9_default_input","selected":false,"source":"kline_node_lz202ib","sourceHandle":"kline_node_lz202ib_output_1","target":"indicator_node_czmwdz9","targetHandle":"indicator_node_czmwdz9_default_input","type":"customEdge"},{"id":"indicator_node_czmwdz9.indicator_node_czmwdz9_default_output=>if_else_node_kkhbgbs.if_else_node_kkhbgbs_default_input","selected":false,"source":"indicator_node_czmwdz9","sourceHandle":"indicator_node_czmwdz9_default_output","target":"if_else_node_kkhbgbs","targetHandle":"if_else_node_kkhbgbs_default_input","type":"customEdge"},{"id":"if_else_node_kkhbgbs.if_else_node_kkhbgbs_output_1=>variable_node_178srlo.variable_node_178srlo_default_input","selected":false,"source":"if_else_node_kkhbgbs","sourceHandle":"if_else_node_kkhbgbs_output_1","target":"variable_node_178srlo","targetHandle":"variable_node_178srlo_default_input","type":"customEdge"},{"id":"variable_node_178srlo.variable_node_178srlo_output_1=>if_else_node_ioon3sv.if_else_node_ioon3sv_default_input","selected":false,"source":"variable_node_178srlo","sourceHandle":"variable_node_178srlo_output_1","target":"if_else_node_ioon3sv","targetHandle":"if_else_node_ioon3sv_default_input","type":"customEdge"},{"id":"if_else_node_ioon3sv.if_else_node_ioon3sv_output_1=>futures_order_node_s3ck6e7.futures_order_node_s3ck6e7_default_input","selected":false,"source":"if_else_node_ioon3sv","sourceHandle":"if_else_node_ioon3sv_output_1","target":"futures_order_node_s3ck6e7","targetHandle":"futures_order_node_s3ck6e7_default_input","type":"customEdge"},{"id":"if_else_node_ioon3sv.if_else_node_ioon3sv_else_output=>variable_node_gu5vsm9.variable_node_gu5vsm9_default_input","selected":false,"source":"if_else_node_ioon3sv","sourceHandle":"if_else_node_ioon3sv_else_output","target":"variable_node_gu5vsm9","targetHandle":"variable_node_gu5vsm9_default_input","type":"customEdge"},{"id":"variable_node_gu5vsm9.variable_node_gu5vsm9_output_1=>if_else_node_958fu8l.if_else_node_958fu8l_default_input","selected":false,"source":"variable_node_gu5vsm9","sourceHandle":"variable_node_gu5vsm9_output_1","target":"if_else_node_958fu8l","targetHandle":"if_else_node_958fu8l_default_input","type":"customEdge"},{"id":"if_else_node_958fu8l.if_else_node_958fu8l_output_1=>position_node_1zwg02h.position_node_1zwg02h_default_input","selected":false,"source":"if_else_node_958fu8l","sourceHandle":"if_else_node_958fu8l_output_1","target":"position_node_1zwg02h","targetHandle":"position_node_1zwg02h_default_input","type":"customEdge"}]);
        let chart_config = json!({"charts":[{"chartName":"BTCUSDT 1m","id":1,"indicatorChartConfigs":[{"indicatorKeyStr":"indicator|binance|BTCUSDT|1m|ma(time_period=14 ma_type=SMA price_source=CLOSE)|2025-11-26 16:00:00 UTC|2025-11-28 16:00:00 UTC","isDelete":false,"isInMainChart":true,"seriesConfigs":[{"color":"#D6D618","indicatorValueKey":"ma","lineWidth":2,"name":"MA","type":"line"}]},{"indicatorKeyStr":"indicator|binance|BTCUSDT|1m|ma(time_period=30 ma_type=SMA price_source=CLOSE)|2025-11-26 16:00:00 UTC|2025-11-28 16:00:00 UTC","isDelete":false,"isInMainChart":true,"seriesConfigs":[{"color":"#1863d6","indicatorValueKey":"ma","lineWidth":2,"name":"MA","type":"line"}]},{"indicatorKeyStr":"indicator|binance|BTCUSDT|1m|ma(time_period=60 ma_type=SMA price_source=CLOSE)|2025-11-26 16:00:00 UTC|2025-11-28 16:00:00 UTC","isDelete":false,"isInMainChart":true,"seriesConfigs":[{"color":"#d6187c","indicatorValueKey":"ma","lineWidth":2,"name":"MA","type":"line"}]},{"indicatorKeyStr":"indicator|binance|BTCUSDT|1m|ma(time_period=21 ma_type=SMA price_source=CLOSE)|2025-11-26 16:00:00 UTC|2025-11-28 16:00:00 UTC","isDelete":false,"isInMainChart":true,"seriesConfigs":[{"color":"#18d654","indicatorValueKey":"ma","lineWidth":2,"name":"MA","type":"line"}]}],"klineChartConfig":{"downColor":"#0000FF","klineKeyStr":"kline|binance|BTCUSDT|1m|2025-11-26 16:00:00 UTC|2025-11-28 16:00:00 UTC","upColor":"#FF0000"}},{"chartName":"BTCUSDT 15m","id":2,"indicatorChartConfigs":[{"indicatorKeyStr":"indicator|binance|BTCUSDT|15m|bbands(time_period=20 dev_up=2 dev_down=2 ma_type=SMA price_source=CLOSE)|2025-11-26 16:00:00 UTC|2025-11-28 16:00:00 UTC","isDelete":false,"isInMainChart":true,"seriesConfigs":[{"color":"#FF6B6B","indicatorValueKey":"upper","lineWidth":2,"name":"upper","type":"line"},{"color":"#4ECDC4","indicatorValueKey":"middle","lineWidth":2,"name":"middle","type":"dash"},{"color":"#45B7D1","indicatorValueKey":"lower","lineWidth":1,"name":"lower","type":"line"}]}],"klineChartConfig":{"downColor":"#0000FF","klineKeyStr":"kline|binance|BTCUSDT|15m|2025-11-26 16:00:00 UTC|2025-11-28 16:00:00 UTC","upColor":"#FF0000"}}],"layout":"vertical"});

        let db = manager.get_connection();
        StrategyConfigActiveModel {
            id: NotSet,
            name: Set("Demo Strategy".to_string()),
            description: Set("This is a strategy for product demonstration.".to_string()),
            status: Set("Stopped".to_string()),
            is_deleted: Set(false),
            trade_mode: Set("backtest".to_string()),
            nodes: Set(Some(nodes)),
            edges: Set(Some(edges)),
            live_chart_config: Set(None),
            backtest_chart_config: Set(Some(chart_config)),
            create_time: Set(Utc::now()),
            update_time: Set(Utc::now()),
        }
        .insert(db)
        .await?;

        Ok(())
    }

    async fn down(&self, manager: &SchemaManager) -> Result<(), DbErr> {
        let db = manager.get_connection();

        StrategyConfigEntity::delete_many()
            .filter(::entity::strategy_config::Column::Name.eq("Demo Strategy1".to_string()))
            .exec(db)
            .await?;

        Ok(())
    }
}
